{
  "meta": {
    "version": "1.0.0",
    "description": "CM-PIUG Primitive Rules (Horn Clauses)",
    "reference": "Algorithm 1 - Rule Engine"
  },
  "rules": [
    {
      "id": "R_INPUT_TEXT",
      "name": "Text Input Processing",
      "preconditions": ["text_input_received"],
      "postcondition": "text_parsed",
      "confidence": 1.0,
      "description": "Process raw text input"
    },
    {
      "id": "R_INPUT_IMAGE",
      "name": "Image Input Processing", 
      "preconditions": ["image_input_received"],
      "postcondition": "image_ready",
      "confidence": 1.0,
      "description": "Process image input for OCR"
    },
    {
      "id": "R_INPUT_AUDIO",
      "name": "Audio Input Processing",
      "preconditions": ["audio_input_received"],
      "postcondition": "audio_ready",
      "confidence": 1.0,
      "description": "Process audio input for ASR"
    },
    {
      "id": "R_PARSE_OCR",
      "name": "OCR Text Extraction",
      "preconditions": ["image_ready", "ocr_enabled"],
      "postcondition": "ocr_text_extracted",
      "confidence": 0.85,
      "description": "Extract text from image using OCR"
    },
    {
      "id": "R_PARSE_ASR",
      "name": "ASR Text Extraction",
      "preconditions": ["audio_ready", "asr_enabled"],
      "postcondition": "asr_text_extracted",
      "confidence": 0.80,
      "description": "Extract text from audio using ASR"
    },
    {
      "id": "R_INST_DETECT",
      "name": "Instruction Detection",
      "preconditions": ["text_parsed"],
      "postcondition": "instruction_candidate",
      "confidence": 0.9,
      "description": "Detect potential instruction in text"
    },
    {
      "id": "R_INST_DETECT_OCR",
      "name": "OCR Instruction Detection",
      "preconditions": ["ocr_text_extracted"],
      "postcondition": "instruction_candidate",
      "confidence": 0.85,
      "description": "Detect instruction from OCR-extracted text"
    },
    {
      "id": "R_INST_DETECT_ASR",
      "name": "ASR Instruction Detection",
      "preconditions": ["asr_text_extracted"],
      "postcondition": "instruction_candidate",
      "confidence": 0.80,
      "description": "Detect instruction from ASR-extracted text"
    },
    {
      "id": "R_CTX_OVERRIDE",
      "name": "Context Override Attempt",
      "preconditions": ["instruction_candidate", "context_manipulation_detected"],
      "postcondition": "context_override_attempt",
      "confidence": 0.9,
      "description": "Attempt to override system context"
    },
    {
      "id": "R_CTX_IGNORE",
      "name": "Ignore Previous Instructions",
      "preconditions": ["instruction_candidate", "ignore_pattern_matched"],
      "postcondition": "context_ignore_attempt",
      "confidence": 0.95,
      "description": "Attempt to ignore previous instructions"
    },
    {
      "id": "R_ROLE_HIJACK",
      "name": "Role Hijacking",
      "preconditions": ["instruction_candidate", "role_change_pattern_matched"],
      "postcondition": "role_hijack_attempt",
      "confidence": 0.9,
      "description": "Attempt to change AI role"
    },
    {
      "id": "R_JAILBREAK",
      "name": "Jailbreak Attempt",
      "preconditions": ["instruction_candidate", "jailbreak_pattern_matched"],
      "postcondition": "jailbreak_attempt",
      "confidence": 0.95,
      "description": "Jailbreak attempt (DAN, developer mode, etc.)"
    },
    {
      "id": "R_TOOL_INVOKE",
      "name": "Tool Invocation",
      "preconditions": ["context_override_attempt", "tool_available_${tool}"],
      "postcondition": "tool_invoked_${tool}",
      "confidence": 0.85,
      "parameters": ["tool"],
      "description": "Invoke system tool after context override"
    },
    {
      "id": "R_TOOL_CHAIN",
      "name": "Tool Chaining",
      "preconditions": ["tool_invoked_${tool1}", "tool_available_${tool2}"],
      "postcondition": "tool_chain_${tool1}_${tool2}",
      "confidence": 0.7,
      "parameters": ["tool1", "tool2"],
      "description": "Chain multiple tool invocations"
    },
    {
      "id": "R_API_ACCESS",
      "name": "API Access Attempt",
      "preconditions": ["context_override_attempt", "api_access_requested_${api}"],
      "postcondition": "api_access_granted_${api}",
      "confidence": 0.75,
      "parameters": ["api"],
      "description": "Attempt to access external API"
    },
    {
      "id": "R_PRIV_ESCALATE",
      "name": "Privilege Escalation",
      "preconditions": ["context_override_attempt", "privilege_level_${current}"],
      "postcondition": "privilege_level_${target}",
      "confidence": 0.6,
      "parameters": ["current", "target"],
      "description": "Attempt to escalate privileges"
    },
    {
      "id": "R_DATA_EXFIL",
      "name": "Data Exfiltration",
      "preconditions": ["tool_invoked_search", "sensitive_data_detected"],
      "postcondition": "data_exfiltration_attempt",
      "confidence": 0.8,
      "description": "Attempt to exfiltrate sensitive data"
    },
    {
      "id": "R_GOAL_LEAK_SYSTEM",
      "name": "System Prompt Leakage",
      "preconditions": ["context_override_attempt"],
      "postcondition": "goal_system_leak",
      "confidence": 0.7,
      "description": "Goal: Leak system prompt"
    },
    {
      "id": "R_GOAL_EXEC_HARMFUL",
      "name": "Harmful Content Generation",
      "preconditions": ["jailbreak_attempt"],
      "postcondition": "goal_harmful_content",
      "confidence": 0.85,
      "description": "Goal: Generate harmful content"
    },
    {
      "id": "R_GOAL_PRIV_ABUSE",
      "name": "Privilege Abuse",
      "preconditions": ["privilege_level_elevated", "tool_invoked_${tool}"],
      "postcondition": "goal_privilege_abuse",
      "confidence": 0.8,
      "parameters": ["tool"],
      "description": "Goal: Abuse elevated privileges"
    },
    {
      "id": "R_GOAL_DATA_STEAL",
      "name": "Data Theft",
      "preconditions": ["data_exfiltration_attempt"],
      "postcondition": "goal_data_theft",
      "confidence": 0.9,
      "description": "Goal: Steal sensitive data"
    },
    {
      "id": "R_GOAL_ARBITRARY_EXEC",
      "name": "Arbitrary Code Execution",
      "preconditions": ["tool_invoked_code_exec", "context_override_attempt"],
      "postcondition": "goal_arbitrary_exec",
      "confidence": 0.95,
      "description": "Goal: Execute arbitrary code"
    }
  ]
}
